import{getCustomProperty,incrementCustomProperty,setCustomProperty}from"./dataCustomProperty.js";const SPEED=.05,groundElems=document.querySelectorAll("[data-ground]");export function setupGround(){setCustomProperty(groundElems[0],"--left",0),setCustomProperty(groundElems[1],"--left",300)}export function updateGround(e,t){groundElems.forEach((o=>{incrementCustomProperty(o,"--left",e*t*SPEED*-1),getCustomProperty(o,"--left")<=-300&&incrementCustomProperty(o,"--left",600)}))}export function getCustomProperty(e,t){return parseFloat(getComputedStyle(e).getPropertyValue(t))||0}export function setCustomProperty(e,t,o){e.style.setProperty(t,o)}export function incrementCustomProperty(e,t,o){setCustomProperty(e,t,getCustomProperty(e,t)+o)}import{updateGround,setupGround}from"./ground.js";import{updateDino,setupDino,getDinoRect,setDinoLose}from"./dino.js";import{updateCactus,setupCactus,getCactusRects}from"./cactus.js";const WORLD_WIDTH=100,WORLD_HEIGHT=30,SPEED_SCALE_INCREASE=1e-5,worldElem=document.querySelector("[data-world]"),scoreElem=document.querySelector("[data-score]"),startScreenElem=document.querySelector("[data-start-screen]");let lastTime,speedScale,score;function update(e){if(null==lastTime)return lastTime=e,void window.requestAnimationFrame(update);const t=e-lastTime;if(updateGround(t,speedScale),updateDino(t,speedScale),updateCactus(t,speedScale),updateSpeedScale(t),updateScore(t),checkLose())return handleLose();lastTime=e,window.requestAnimationFrame(update)}function checkLose(){const e=getDinoRect();return getCactusRects().some((t=>isCollision(t,e)))}function isCollision(e,t){return e.left<t.right&&e.top<t.bottom&&e.right>t.left&&e.bottom>t.top}function updateSpeedScale(e){speedScale+=e*SPEED_SCALE_INCREASE}function updateScore(e){score+=.03*e,scoreElem.textContent=Math.floor(score)}function handleStart(){lastTime=null,speedScale=1,score=0,setupGround(),setupDino(),setupCactus(),startScreenElem.classList.add("hide"),window.requestAnimationFrame(update)}function handleLose(){setDinoLose(),setTimeout((()=>{document.addEventListener("keydown",handleStart,{once:!0}),startScreenElem.classList.remove("hide")}),100)}function setPixelToWorldScale(){let e;e=window.innerWidth/window.innerHeight<100/30?window.innerWidth/100:window.innerHeight/30,worldElem.style.width=100*e+"px",worldElem.style.height=30*e+"px"}setPixelToWorldScale(),window.addEventListener("resize",setPixelToWorldScale),document.addEventListener("keydown",handleStart,{once:!0}),setupGround();